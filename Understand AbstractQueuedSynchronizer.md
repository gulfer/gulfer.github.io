# 理解AbstractQueuedSynchronizer

AbstractQueueSynchronizer(AQS)是Java自1.5版本新增的一个基类，字面意思是队列同步器，简单来说是对线程建同步机制进行的抽象。可以通过查看其继承关系，了解到JDK concurrent包下许多组件都是基于此基类实现线程同步，反过来说，理解AQS将帮助开发者理解concurrent包。

## 线程同步

我理解线程同步就是多线程并发下竞争共享资源的使用权时按某些策略进行排队，最终达到共享资源的有序使用。顺带提一句，线程通信和线程同步是两个不同范畴的概念，通信是通过某种方式传递消息，对Java来说比如wait、notify、共享变量等；而线程同步是针对并发编程中资源竞争而言。那么怎么做到共享资源的有序使用，常见的做法就是加锁，这就用到AQS了。

## AQS原理及源码分析

从类名就可以看出来这是个基类，而且有队列，是同步用的，大神给类起名字都有水平。

我们先简单看看AQS的使用。像我们比较常用的ReentrantLock、CountDownLatch等都使用了AQS，但并不是通过直接继承的方式，而是用静态内部类继承AQS，而在类中用聚合的方式来使用同步器的能力。这样做符合OOP多聚合、少继承的原则，为实现提供了更大的灵活性，其实就是典型的对象适配器。

在回到AQS的实现原理上。AQS主要基于两个东西构建同步功能，一是volatile int的同步状态，一个是FIFO的队列（其实是双向链表）。

状态

队列

## AQS使用示例

下面是一个使用AQS的例子



